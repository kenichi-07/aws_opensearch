from opensearchpy import OpenSearch
from elasticsearch import Elasticsearch
 
host = [{'host': 'xxx.xxx.xxx.xxx', 'port': 9200}, 
        {'host': 'xxx.xxx.xxx.xxx', 'port': 9200}, 
        {'host': 'xxx.xxx.xxx.xxx', 'port': 9200}]
auth = ('icopensearch', '<Password>')
ca_certs_path = '/path_to_the_certificate/cluster-ca-certificate.pem'
 
 
client = OpenSearch(
    hosts=host,
    http_compress=True,
    http_auth=auth,
    use_ssl=True,
    verify_certs=True,
    ssl_assert_hostname=False,
    ssl_show_warn=False,
    ca_certs=ca_certs_path
)

#Get Indices
GET index_name/_search
{"sort": [
  {
    "FIELD": {
      "order": "desc"
    }
  }
]}

#get health
es = Elasticsearch(host)
print(es.cat.health())


# Delete the index.
response = client.indices.delete(
    index = index_name
)

print('\nDeleting index:')
print(response)

#connect elasticsearch
import requests
from elasticsearch import Elasticsearch
substring = "You Know, for Search".encode()
response = requests.get("http://127.0.0.1:9200")
if substring in response.content:
   es = Elasticsearch([{"host": "localhost", "port": 9200}])